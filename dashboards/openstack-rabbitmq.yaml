apiVersion: perses.dev/v1alpha1
kind: PersesDashboard
metadata:
    namespace: ""
    name: openstack-rabbitmq.go
spec:
    display:
        name: OpenStack / RabbitMQ
    variables:
        - kind: ListVariable
          spec:
            display:
                name: RabbitMQ Cluster
                hidden: false
            allowAllValue: false
            allowMultiple: false
            plugin:
                kind: PrometheusLabelValuesVariable
                spec:
                    labelName: instance
                    matchers:
                        - rabbitmq_identity_info
            name: cluster
    panels:
        "0":
            kind: Panel
            spec:
                display:
                    name: Queues
                    description: Number of message queues
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "1":
            kind: Panel
            spec:
                display:
                    name: Consumers
                    description: Number of message consumers
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "2":
            kind: Panel
            spec:
                display:
                    name: Connections
                    description: Number of RabbitMQ connections
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "3":
            kind: Panel
            spec:
                display:
                    name: Channels
                    description: Number of RabbitMQ channels
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "4":
            kind: Panel
            spec:
                display:
                    name: Incoming messages / s
                    description: Number of incomming messages per second
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "5":
            kind: Panel
            spec:
                display:
                    name: Outgoing messages / s
                    description: Number of outgoing messages per second
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "6":
            kind: Panel
            spec:
                display:
                    name: Ready messages
                    description: Number of ready messages
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "7":
            kind: Panel
            spec:
                display:
                    name: Unacknowledged messages
                    description: Number of unacknowledged messages
                plugin:
                    kind: Markdown
                    spec:
                        text: '**Migration from Grafana not supported !**'
        "8":
            kind: Panel
            spec:
                display:
                    name: Memory available before publishers blocked
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: |-
                                    (rabbitmq_resident_memory_limit_bytes{instance="$cluster"}) -
                                    (rabbitmq_process_resident_memory_bytes{instance="$cluster"})
                                seriesNameFormat: ""
        "9":
            kind: Panel
            spec:
                display:
                    name: Disk space available before publishers blocked
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: rabbitmq_disk_space_available_bytes{instance="$cluster"}
                                seriesNameFormat: ""
        "10":
            kind: Panel
            spec:
                display:
                    name: File descriptors available
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: |-
                                    (rabbitmq_process_max_fds{instance="$cluster"}) -
                                    (rabbitmq_process_open_fds{instance="$cluster"})
                                seriesNameFormat: ""
        "11":
            kind: Panel
            spec:
                display:
                    name: TCP sockets available
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: |-
                                    (rabbitmq_process_max_tcp_sockets{instance="$cluster"}) -
                                    (rabbitmq_process_open_tcp_sockets{instance="$cluster"})
                                seriesNameFormat: ""
        "12":
            kind: Panel
            spec:
                display:
                    name: Messages ready to be delivered
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rabbitmq_queue_messages_ready{instance="$cluster"})
                                seriesNameFormat: ""
        "13":
            kind: Panel
            spec:
                display:
                    name: Unacknowledged messages
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rabbitmq_queue_messages_unacked{instance="$cluster"})
                                seriesNameFormat: ""
        "14":
            kind: Panel
            spec:
                display:
                    name: Messages published / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_received_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "15":
            kind: Panel
            spec:
                display:
                    name: Messages confirmed / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_confirmed_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "16":
            kind: Panel
            spec:
                display:
                    name: Messages routed to queues / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_routed_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "17":
            kind: Panel
            spec:
                display:
                    name: Unconfirmed messages / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: "sum(rate(rabbitmq_global_messages_received_confirm_total{instance=\"$cluster\"}[60s]) - \nrate(rabbitmq_global_messages_confirmed_total{instance=\"$cluster\"}[60s])\n)"
                                seriesNameFormat: ""
        "18":
            kind: Panel
            spec:
                display:
                    name: Unroutable messages dropped / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_unroutable_dropped_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "19":
            kind: Panel
            spec:
                display:
                    name: Unroutable messages returned to publishers / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_unroutable_returned_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "20":
            kind: Panel
            spec:
                display:
                    name: Messages delivered / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: |-
                                    sum(
                                      rate(rabbitmq_global_messages_delivered_consume_auto_ack_total{instance="$cluster"}[60s])+
                                      rate(rabbitmq_global_messages_delivered_consume_manual_ack_total{instance="$cluster"}[60s])
                                    )
                                seriesNameFormat: ""
        "21":
            kind: Panel
            spec:
                display:
                    name: Messages redelivered / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_redelivered_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "22":
            kind: Panel
            spec:
                display:
                    name: Messages delivered with manual acks / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_delivered_consume_manual_ack_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "23":
            kind: Panel
            spec:
                display:
                    name: Messages delivered with auto acks / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_delivered_consume_auto_ack_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "24":
            kind: Panel
            spec:
                display:
                    name: Messages acknowledged / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_acknowledged_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "25":
            kind: Panel
            spec:
                display:
                    name: Polling operations with auto ack / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_delivered_get_auto_ack_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "26":
            kind: Panel
            spec:
                display:
                    name: Polling operations that yield no result / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_get_empty_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "27":
            kind: Panel
            spec:
                display:
                    name: Polling operations with manual ack / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_global_messages_delivered_get_manual_ack_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "28":
            kind: Panel
            spec:
                display:
                    name: Total queues
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: rabbitmq_queues{instance="$cluster"}
                                seriesNameFormat: ""
        "29":
            kind: Panel
            spec:
                display:
                    name: Queues declared / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_queues_declared_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "30":
            kind: Panel
            spec:
                display:
                    name: Queues created / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_queues_created_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "31":
            kind: Panel
            spec:
                display:
                    name: Queues deleted / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_queues_deleted_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "32":
            kind: Panel
            spec:
                display:
                    name: Total channels
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: rabbitmq_channels{instance="$cluster"}
                                seriesNameFormat: ""
        "33":
            kind: Panel
            spec:
                display:
                    name: Channels opened / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_channels_opened_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "34":
            kind: Panel
            spec:
                display:
                    name: Channels closed / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_channels_closed_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "35":
            kind: Panel
            spec:
                display:
                    name: Total connections
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: rabbitmq_connections{instance="$cluster"}
                                seriesNameFormat: ""
        "36":
            kind: Panel
            spec:
                display:
                    name: Connections opened / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_connections_opened_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
        "37":
            kind: Panel
            spec:
                display:
                    name: Connections closed / s
                plugin:
                    kind: TimeSeriesChart
                    spec: {}
                queries:
                    - kind: TimeSeriesQuery
                      spec:
                        plugin:
                            kind: PrometheusTimeSeriesQuery
                            spec:
                                minStep: ""
                                query: sum(rate(rabbitmq_connections_closed_total{instance="$cluster"}[60s]))
                                seriesNameFormat: ""
    layouts:
        - kind: Grid
          spec:
            display:
                title: Panel Group 1
            items:
                - x: 0
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/0'
                - x: 3
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/1'
                - x: 6
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/2'
                - x: 9
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/3'
                - x: 12
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/4'
                - x: 15
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/5'
                - x: 18
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/6'
                - x: 21
                  "y": 1
                  width: 3
                  height: 6
                  content:
                    $ref: '#/spec/panels/7'
                - x: 0
                  "y": 2
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/8'
                - x: 12
                  "y": 2
                  width: 8
                  height: 8
                  content:
                    $ref: '#/spec/panels/9'
                - x: 20
                  "y": 2
                  width: 4
                  height: 4
                  content:
                    $ref: '#/spec/panels/10'
                - x: 20
                  "y": 6
                  width: 4
                  height: 4
                  content:
                    $ref: '#/spec/panels/11'
                - x: 0
                  "y": 3
                  width: 12
                  height: 9
                  content:
                    $ref: '#/spec/panels/12'
                - x: 12
                  "y": 3
                  width: 12
                  height: 9
                  content:
                    $ref: '#/spec/panels/13'
                - x: 0
                  "y": 4
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/14'
                - x: 12
                  "y": 4
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/15'
                - x: 0
                  "y": 12
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/16'
                - x: 12
                  "y": 12
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/17'
                - x: 0
                  "y": 20
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/18'
                - x: 12
                  "y": 20
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/19'
                - x: 0
                  "y": 5
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/20'
                - x: 12
                  "y": 5
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/21'
                - x: 0
                  "y": 13
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/22'
                - x: 12
                  "y": 13
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/23'
                - x: 0
                  "y": 21
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/24'
                - x: 12
                  "y": 21
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/25'
                - x: 0
                  "y": 29
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/26'
                - x: 12
                  "y": 29
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/27'
                - x: 0
                  "y": 6
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/28'
                - x: 12
                  "y": 6
                  width: 4
                  height: 8
                  content:
                    $ref: '#/spec/panels/29'
                - x: 16
                  "y": 6
                  width: 4
                  height: 8
                  content:
                    $ref: '#/spec/panels/30'
                - x: 20
                  "y": 6
                  width: 4
                  height: 8
                  content:
                    $ref: '#/spec/panels/31'
                - x: 0
                  "y": 7
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/32'
                - x: 12
                  "y": 7
                  width: 6
                  height: 8
                  content:
                    $ref: '#/spec/panels/33'
                - x: 18
                  "y": 7
                  width: 6
                  height: 8
                  content:
                    $ref: '#/spec/panels/34'
                - x: 0
                  "y": 8
                  width: 12
                  height: 8
                  content:
                    $ref: '#/spec/panels/35'
                - x: 12
                  "y": 8
                  width: 6
                  height: 8
                  content:
                    $ref: '#/spec/panels/36'
                - x: 18
                  "y": 8
                  width: 6
                  height: 8
                  content:
                    $ref: '#/spec/panels/37'
    duration: 1h

